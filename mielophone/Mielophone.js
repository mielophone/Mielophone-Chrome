(function(){var a;a=function(){function a(){var a=this;require(["../mielophone/services/Discogs"],function(){return a.discogs=new Discogs}),window.plugins=[]}return a.prototype.queryAll=function(a,b){var c=this;return this.discogs.search(a,function(d){var e;return e=d,c.findAllMp3s(a,function(a){return e=e.concat(a),b(e)})})},a.prototype.getStreamUrl=function(a,b){var c,d,e,f,g,h,i,j,k;c=!1,j=window.plugins;for(f=0,h=j.length;f<h;f++){e=j[f],k=e.songs;for(g=0,i=k.length;g<i;g++){d=k[g];if(d.id===a){c=!0;break}}if(c)break}return e.getStreamUrl(d.url,function(a){return b(a),!0})},a.prototype.findStream=function(a,b,c){var d,e,f,g,h;return h=null,d=window.plugins.length,e=0,g=function(a){return a!==null?e.getStreamUrl(h.url,function(a){return c(a)}):(e++,f())},f=function(){var f;return e>=d&&c(!1),f=window.plugins[e],f.findStream(a,b,g)},f(),!0},a.prototype.findAllMp3s=function(a,b){var c,d,e,f,g,h,i;e=[],c=window.plugins.length,h=window.plugins,i=[];for(f=0,g=h.length;f<g;f++)d=h[f],i.push(d.query(a,function(a){var d,f,g;for(f=0,g=a.length;f<g;f++)d=a[f],e.push(d);return c--,c<=0&&b(e),!0}));return i},a.prototype.getDiscography=function(a,b){return this.discogs.getDiscography(a,b)},a.prototype.getAlbumTracklist=function(a,b,c,d){return this.discogs.getAlbumTracklist(a,b,c,d)},a}(),window.Mielophone=new a}).call(this);